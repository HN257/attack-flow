{"$schema":"./attack_flow_2022-10-03_11-41-42.json","flow":{"type":"attack-flow","id":"http://flow-1","name":"Attack Flow Export","author":"Unspecified","created":"2022-10-03T22:11:42+10:30"},"actions":[{"id":"http://flow-1/action-6","type":"action","name":"T1595.002: Active Scanning: Vulnerability Scanning","description":"Scan victims for vulnerabilities (Internet-facing ports and services, conduct device finger[rinting); check if the configuration of a target host/application potentially aligns with the target of a specific exploit the adversary may seek to use","timestamp":"","reference":"https://attack.mitre.org/techniques/T1595/002/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-14","type":"action","name":"T1602.001: Data from Configuration Repository: SNMP (MIB Dump)","description":"Collect and/or mine valuable information in a network managed using Simple Network Management Protocol (SNMP)","timestamp":"","reference":"https://attack.mitre.org/techniques/T1602/001/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-19","type":"action","name":"T1552.001: Unsecured Credentials: Credentials In Files","description":"Search configuration files of a system or service to derive password hash values for legitimate credentials","timestamp":"","reference":"https://attack.mitre.org/techniques/T1552/001/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-24","type":"action","name":"T1110.004: Brute Force: Credential Stuffing","description":"Use brute-force attacks to obtain Telnet and SSH login credentials","timestamp":"","reference":"https://attack.mitre.org/techniques/T1110/004/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"},{"id":"http://flow-1/action-25","type":"action","name":"T1550.002: Use Alternate Authentication Material: Pass the Hash","description":"Use stolen password hashes to move laterally within an environment, bypassing normal system access controls","timestamp":"","reference":"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"},{"id":"http://flow-1/action-28","type":"action","name":"T1021: Remote Services","description":"Use Valid Accounts to authenticate into the device as a privileged user via remote management services","timestamp":"","reference":"https://attack.mitre.org/techniques/T1021/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-29","type":"action","name":"T1072: Software Deployment Tools","description":"Gain access to and take advantages of the unauthenticated SMI design installed within the enterprise network; leveraged","timestamp":"","reference":"https://attack.mitre.org/techniques/T1072/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-30","type":"action","name":"T1543: Create or Modify System Process","description":"Modify the device configurations; upload maliciously modified OS or firmware","timestamp":"","reference":"https://attack.mitre.org/techniques/T1543/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-37","type":"action","name":"T1557: Adversary-in-the-Middle","description":"Create man-in-the-middle scenarios","timestamp":"","reference":"https://attack.mitre.org/techniques/T1557/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-46","type":"action","name":"T1205: Traffic Signaling","description":"Send specially crafted SNMP and SMI packets to trigger the scanned device to send information to a cyber-actor-controlled host via TFTP/UDP port 69 from external devices","timestamp":"","reference":"https://attack.mitre.org/techniques/T1205/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-62","type":"action","name":"T1078: Valid Accounts","description":"Use compromised credentials to bypass access controls and increase privilege to specific systems/restricted areas","timestamp":"","reference":"https://attack.mitre.org/techniques/T1078/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"},{"id":"http://flow-1/action-70","type":"action","name":"T1190: Exploit Public-Facing Application","description":"Take advantage of a weakness in an Internet-facing computer or program including standard services (like SSH), network device administration and management protocols (like SNMP and Smart Install), and any other applications with Internet accessible open sockets.","timestamp":"","reference":"https://attack.mitre.org/techniques/T1190/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-73","type":"action","name":"T1564.010: Hide Artifacts: Process Argument Spoofing","description":"Spoof source address of the SNMP UDP datagram as coming from inside the targeted network","timestamp":"","reference":"https://attack.mitre.org/techniques/T1564/010/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}],"assets":[{"id":"http://flow-1/asset-7","type":"asset","state":"enabled"},{"id":"http://flow-1/asset-8","type":"asset","state":"scanned"},{"id":"http://flow-1/asset-15","type":"asset","state":"triggered"},{"id":"http://flow-1/asset-16","type":"asset","state":"blocked"},{"id":"http://flow-1/asset-20","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-26","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-27","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-33","type":"asset","state":"Persistence enabled"},{"id":"http://flow-1/asset-48","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-55","type":"asset","state":"SMI abused"},{"id":"http://flow-1/asset-64","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-72","type":"asset","state":"compromised"}],"relationships":[{"source":"http://flow-1/asset-7","type":"http://flow-1#state","target":"http://flow-1/action-6"},{"source":"http://flow-1/action-6","type":"http://flow-1#state-change","target":"http://flow-1/asset-8"},{"source":"http://flow-1/action-19","type":"http://flow-1#state-change","target":"http://flow-1/asset-20"},{"source":"http://flow-1/asset-20","type":"http://flow-1#state","target":"http://flow-1/action-24"},{"source":"http://flow-1/asset-20","type":"http://flow-1#state","target":"http://flow-1/action-25"},{"source":"http://flow-1/action-24","type":"http://flow-1#state-change","target":"http://flow-1/asset-26"},{"source":"http://flow-1/asset-26","type":"http://flow-1#state","target":"http://flow-1/action-28"},{"source":"http://flow-1/action-30","type":"http://flow-1#state-change","target":"http://flow-1/asset-33"},{"source":"http://flow-1/asset-8","type":"http://flow-1#state","target":"http://flow-1/action-46"},{"source":"http://flow-1/action-46","type":"http://flow-1#state-change","target":"http://flow-1/asset-16"},{"source":"http://flow-1/action-46","type":"http://flow-1#state-change","target":"http://flow-1/asset-15"},{"source":"http://flow-1/asset-15","type":"http://flow-1#state","target":"http://flow-1/action-14"},{"source":"http://flow-1/action-14","type":"http://flow-1#state-change","target":"http://flow-1/asset-48"},{"source":"http://flow-1/asset-15","type":"http://flow-1#state","target":"http://flow-1/action-19"},{"source":"http://flow-1/action-29","type":"http://flow-1#state-change","target":"http://flow-1/asset-55"},{"source":"http://flow-1/asset-27","type":"http://flow-1#state","target":"http://flow-1/action-29"},{"source":"http://flow-1/asset-55","type":"http://flow-1#state","target":"http://flow-1/action-30"},{"source":"http://flow-1/action-28","type":"http://flow-1#state-change","target":"http://flow-1/asset-27"},{"source":"http://flow-1/asset-20","type":"http://flow-1#state","target":"http://flow-1/action-62"},{"source":"http://flow-1/action-62","type":"http://flow-1#state-change","target":"http://flow-1/asset-26"},{"source":"http://flow-1/action-25","type":"http://flow-1#state-change","target":"http://flow-1/asset-26"},{"source":"http://flow-1/asset-33","type":"http://flow-1#state","target":"http://flow-1/action-37"},{"source":"http://flow-1/action-37","type":"http://flow-1#state-change","target":"http://flow-1/asset-64"},{"source":"http://flow-1/action-70","type":"http://flow-1#state-change","target":"http://flow-1/asset-7"},{"source":"http://flow-1/asset-72","type":"http://flow-1#state","target":"http://flow-1/action-70"},{"source":"http://flow-1/asset-16","type":"http://flow-1#state","target":"http://flow-1/action-73"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-6"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-14"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-19"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-24"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-25"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-28"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-29"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-30"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-37"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-46"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-62"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-70"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-73"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-7"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-8"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-15"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-16"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-20"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-26"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-27"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-33"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-48"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-55"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-64"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-72"}],"object_properties":[{"source":"http://flow-1/action-29","type":"http://flow-1#factor","target":"http://flow-1#SMI-supported-Cisco-switch/router"}],"data_properties":[{"source":"http://flow-1/asset-7","type":"http://flow-1#state","target":"unencrypted"},{"source":"http://flow-1/asset-7","type":"http://flow-1#state","target":"unauthenticated"},{"source":"http://flow-1/asset-7","type":"http://flow-1#state","target":"insufficiently hardened"},{"source":"http://flow-1/asset-7","type":"http://flow-1#state","target":"end-of-life"},{"source":"http://flow-1/asset-8","type":"http://flow-1#description","target":"Login banners & data"},{"source":"http://flow-1/asset-15","type":"http://flow-1#state","target":"Director and clients on the same network"},{"source":"http://flow-1/asset-26","type":"http://flow-1#description","target":"Telnet/SSH credentials"},{"source":"http://flow-1/asset-15","type":"http://flow-1#description","target":"Device configuration files"},{"source":"http://flow-1/asset-8","type":"http://flow-1#description","target":"Protocol ports"},{"source":"http://flow-1/asset-48","type":"http://flow-1#description","target":"SNMP community strings"},{"source":"http://flow-1/asset-48","type":"http://flow-1#description","target":"Network information"},{"source":"http://flow-1/asset-20","type":"http://flow-1#description","target":"Legitimate credentials"},{"source":"http://flow-1/asset-27","type":"http://flow-1#state","target":"Remote install and configure device enabled"},{"source":"http://flow-1/asset-27","type":"http://flow-1#description","target":"Smart Install Exploitation Tool (SIET)"},{"source":"http://flow-1/asset-55","type":"http://flow-1#description","target":"Leverage capability"},{"source":"http://flow-1/asset-26","type":"http://flow-1#description","target":"Router access"},{"source":"http://flow-1/asset-33","type":"http://flow-1#description","target":"Writeable file structures to store malware"},{"source":"http://flow-1/asset-33","type":"http://flow-1#description","target":"Privileged command execution"},{"source":"http://flow-1/asset-64","type":"http://flow-1#description","target":"Additional configuration information extraction"},{"source":"http://flow-1/asset-64","type":"http://flow-1#description","target":"OS image file export to external FTP server"},{"source":"http://flow-1/asset-64","type":"http://flow-1#description","target":"Device configurations modification"},{"source":"http://flow-1/asset-64","type":"http://flow-1#description","target":"Generic Routing Encapsulation (GRE) tunnels creation"},{"source":"http://flow-1/asset-64","type":"http://flow-1#description","target":"Mirror or redirect network traffic"},{"source":"http://flow-1/asset-72","type":"http://flow-1#description","target":"Network Devices"},{"source":"http://flow-1/asset-72","type":"http://flow-1#state","target":"publicly accessible"}]}