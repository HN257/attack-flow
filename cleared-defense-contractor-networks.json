{"$schema":"./attack_flow_2022-10-10_13-08-41.json","flow":{"type":"attack-flow","id":"http://flow-1","name":"Attack Flow Export","author":"Unspecified","created":"2022-10-10T23:38:41+10:30"},"actions":[{"id":"http://flow-1/action-1","type":"action","name":"T1110: Brute Force","description":"Use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained","timestamp":"","reference":"https://attack.mitre.org/techniques/T1110/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-3","type":"action","name":"T1589.001: Gather Victim Identity Information: Credentials","description":"Identify valid account credentials for domain and M365 accounts","timestamp":"","reference":"https://attack.mitre.org/techniques/T1589/001/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-7","type":"action","name":"T1566.002: Phishing: Spearphishing Link","description":"Send spearphishing emails with links to malicious domains","timestamp":"","reference":"https://attack.mitre.org/techniques/T1566/002/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-10","type":"action","name":"T1027: Obfuscated Files or Information","description":"Use publicly available URL shortening services to mask the link instead of actor-controlled malicious domains to bypass virus and spam scanning tools. This obfuscation technique often promotes a false legitimacy to the email recipient, increasing the probability of a victim's clicking on the link","timestamp":"","reference":"https://attack.mitre.org/techniques/T1027/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-12","type":"action","name":"T1078: Valid Accounts","description":"Harvest credentials of existing accounts","timestamp":"","reference":"https://attack.mitre.org/techniques/T1078/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-13","type":"action","name":"T1190: Exploit Public-Facing Application","description":"Take advantage of known vulnerabilities (e.g., CVE-2020-0688, CVE-2020-17144) on public-facing applications such as VPNs","timestamp":"","reference":"https://attack.mitre.org/techniques/T1190/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-17","type":"action","name":"T1133: External Remote Services","description":"Research vulnerabilities in Fortinet's FortiGate VPN devices, brute-forcing, and leveraging CVE-2018-13379","timestamp":"","reference":"https://attack.mitre.org/techniques/T1133/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-18","type":"action","name":"T1003.003: OS Credential Dumping: NTDS","description":"Connect to domain controllers, exfiltrate credentials, access and export copies of the AD database ntds.dit","timestamp":"","reference":"https://attack.mitre.org/techniques/T1003/003/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-26","type":"action","name":"T1078.002: Valid Accounts: Domain Accounts","description":"Use Mimikatz to dump admin credentials from AD","timestamp":"","reference":"https://attack.mitre.org/techniques/T1078/002/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-32","type":"action","name":"T1213.002: Data from Information Repositories: SharePoint","description":"Use valid M365 global admin credentials to log into the administrative portal and change permissions of an existing enterprise application to give read access to all SharePoint [page","timestamp":"","reference":"https://attack.mitre.org/techniques/T1213/002/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-37","type":"action","name":"T1078.004: Valid Accounts: Cloud Accounts","description":"Gain access to M365 accounts through AD admin credentials","timestamp":"","reference":"https://attack.mitre.org/techniques/T1078/002/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-39","type":"action","name":"T1078.002: Valid Accounts: Domain Accounts","description":"Abuse domain credentials","timestamp":"","reference":"https://attack.mitre.org/techniques/T1078/002/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-40","type":"action","name":"T1083: File and Network Discovery","description":"Use BloodHound to map the Active Directory (AD)","timestamp":"","reference":"https://attack.mitre.org/techniques/T1083/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-42","type":"action","name":"T1482: Domain Trust Discovery","description":"Gather information on domain trust relationships and use to identify lateral movement opportunities - M365 for example","timestamp":"","reference":"https://attack.mitre.org/techniques/T1482/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-43","type":"action","name":"T1114.002: Email Collection: Remote Email Collection","description":"Use legitimate credentials to exfiltrate emails from the victim's enterprise email system","timestamp":"","reference":"https://attack.mitre.org/techniques/T1114/002/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-46","type":"action","name":"T1078: Valid Accounts","description":"Rely on possession of legitimate credentials, enabling pivoting to other accounts ","timestamp":"","reference":"https://attack.mitre.org/techniques/T1078/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-49","type":"action","name":"T1090.003: Proxy: Multi-hop Proxy","description":"Routinely use multiple disparate nodes, such as virtual private server (VPSs) as an encrypted proxy, and small office and home office (SOHO) devices as operational nodes, to evade detection and route traffic to the target","timestamp":"","reference":"https://attack.mitre.org/techniques/T1090/003/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}],"assets":[{"id":"http://flow-1/asset-2","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-4","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-8","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-11","type":"asset","state":"phished"},{"id":"http://flow-1/asset-14","type":"asset","state":"privileges escalated"},{"id":"http://flow-1/asset-19","type":"asset","state":"AD mapped"},{"id":"http://flow-1/asset-27","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-29","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-33","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-41","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-44","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-47","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-48","type":"asset","state":"persisted"},{"id":"http://flow-1/asset-50","type":"asset","state":"compromised"}],"relationships":[{"source":"http://flow-1/action-1","type":"http://flow-1#state-change","target":"http://flow-1/asset-2"},{"source":"http://flow-1/asset-2","type":"http://flow-1#state","target":"http://flow-1/action-3"},{"source":"http://flow-1/action-3","type":"http://flow-1#state-change","target":"http://flow-1/asset-4"},{"source":"http://flow-1/asset-4","type":"http://flow-1#state","target":"http://flow-1/action-7"},{"source":"http://flow-1/action-7","type":"http://flow-1#state-change","target":"http://flow-1/asset-8"},{"source":"http://flow-1/asset-8","type":"http://flow-1#state","target":"http://flow-1/action-10"},{"source":"http://flow-1/action-10","type":"http://flow-1#state-change","target":"http://flow-1/asset-11"},{"source":"http://flow-1/asset-11","type":"http://flow-1#state","target":"http://flow-1/action-12"},{"source":"http://flow-1/action-13","type":"http://flow-1#state-change","target":"http://flow-1/asset-14"},{"source":"http://flow-1/asset-14","type":"http://flow-1#state","target":"http://flow-1/action-18"},{"source":"http://flow-1/asset-11","type":"http://flow-1#state","target":"http://flow-1/action-13"},{"source":"http://flow-1/action-12","type":"http://flow-1#state-change","target":"http://flow-1/asset-14"},{"source":"http://flow-1/action-17","type":"http://flow-1#state-change","target":"http://flow-1/asset-14"},{"source":"http://flow-1/asset-19","type":"http://flow-1#state","target":"http://flow-1/action-26"},{"source":"http://flow-1/action-26","type":"http://flow-1#state-change","target":"http://flow-1/asset-27"},{"source":"http://flow-1/asset-29","type":"http://flow-1#state","target":"http://flow-1/action-32"},{"source":"http://flow-1/action-32","type":"http://flow-1#state-change","target":"http://flow-1/asset-33"},{"source":"http://flow-1/asset-27","type":"http://flow-1#state","target":"http://flow-1/action-37"},{"source":"http://flow-1/action-37","type":"http://flow-1#state-change","target":"http://flow-1/asset-29"},{"source":"http://flow-1/asset-33","type":"http://flow-1#state","target":"http://flow-1/action-39"},{"source":"http://flow-1/action-18","type":"http://flow-1#state-change","target":"http://flow-1/asset-41"},{"source":"http://flow-1/asset-41","type":"http://flow-1#state","target":"http://flow-1/action-40"},{"source":"http://flow-1/action-40","type":"http://flow-1#state-change","target":"http://flow-1/asset-19"},{"source":"http://flow-1/asset-41","type":"http://flow-1#state","target":"http://flow-1/action-42"},{"source":"http://flow-1/action-42","type":"http://flow-1#state-change","target":"http://flow-1/asset-27"},{"source":"http://flow-1/action-43","type":"http://flow-1#state-change","target":"http://flow-1/asset-44"},{"source":"http://flow-1/action-39","type":"http://flow-1#state-change","target":"http://flow-1/asset-47"},{"source":"http://flow-1/asset-47","type":"http://flow-1#state","target":"http://flow-1/action-43"},{"source":"http://flow-1/asset-44","type":"http://flow-1#state","target":"http://flow-1/action-46"},{"source":"http://flow-1/action-46","type":"http://flow-1#state-change","target":"http://flow-1/asset-48"},{"source":"http://flow-1/asset-44","type":"http://flow-1#state","target":"http://flow-1/action-49"},{"source":"http://flow-1/action-49","type":"http://flow-1#state-change","target":"http://flow-1/asset-50"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-1"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-3"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-7"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-10"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-12"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-13"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-17"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-18"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-26"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-32"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-37"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-39"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-40"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-42"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-43"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-46"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-49"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-2"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-4"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-8"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-11"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-14"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-19"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-27"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-29"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-33"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-41"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-44"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-47"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-48"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-50"}],"object_properties":[],"data_properties":[{"source":"http://flow-1/asset-4","type":"http://flow-1#description","target":"domain credentials"},{"source":"http://flow-1/asset-4","type":"http://flow-1#description","target":"initial network access"},{"source":"http://flow-1/asset-14","type":"http://flow-1#description","target":"remote code execution (RCE)"},{"source":"http://flow-1/asset-27","type":"http://flow-1#description","target":"admin credentials"},{"source":"http://flow-1/asset-29","type":"http://flow-1#description","target":"M365 global admin accounts"},{"source":"http://flow-1/asset-29","type":"http://flow-1#description","target":"M365 resources"},{"source":"http://flow-1/asset-33","type":"http://flow-1#description","target":"SharePoint pages"},{"source":"http://flow-1/asset-33","type":"http://flow-1#description","target":"user profiles & emails"},{"source":"http://flow-1/asset-41","type":"http://flow-1#description","target":"AD database ntds.dit"},{"source":"http://flow-1/asset-41","type":"http://flow-1#description","target":"user credentials"},{"source":"http://flow-1/asset-44","type":"http://flow-1#description","target":"user emails' sensitive information"},{"source":"http://flow-1/asset-50","type":"http://flow-1#description","target":"remote control"}]}