{"$schema":"./attack_flow_2022-10-03_11-43-10.json","flow":{"type":"attack-flow","id":"http://flow-1","name":"Attack Flow Export","author":"Unspecified","created":"2022-10-03T22:13:10+10:30"},"actions":[{"id":"http://flow-1/action-1","type":"action","name":"T0818: Engineering Workstation Compromise","description":"Compromise workstations within the safety network","timestamp":"","reference":"https://attack.mitre.org/techniques/T0818/","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-5","type":"action","name":"T0858: Change Operating Mode","description":"Halt or run a program through the TriStation protocol","timestamp":"","reference":"https://attack.mitre.org/techniques/T0858/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"OR"},{"id":"http://flow-1/action-6","type":"action","name":"T0871: Execution through API","description":"Leverage a custom implementation of the TriStation protocol, which trigger APIs related to program download, program allocation, and program changes","timestamp":"","reference":"https://attack.mitre.org/techniques/T0871/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"OR"},{"id":"http://flow-1/action-9","type":"action","name":"T0874: Hooking","description":"TRITON's injector modifies the address of the handler for a TriStation protocol command so that when the command is received, the payload may be executed instead of normal processing","timestamp":"","reference":"https://attack.mitre.org/techniques/T0874/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-11","type":"action","name":"T0821: Modify Controller Tasking","description":"Some TRITON components are added to the program table on the Tricon so that they are executed by the firmware once each cycle","timestamp":"","reference":"https://attack.mitre.org/techniques/T0821/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-13","type":"action","name":"T0834: Native API","description":"TRITON's payload takes commands from TsHi.ExplReadRam(Ex), TsHi.ExplWriteRam(Ex), and TsHi.ExplExec functions to perform operations on controller memory and registers using syscalls written in PowerPC shellcode","timestamp":"","reference":"https://attack.mitre.org/techniques/T0834/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-15","type":"action","name":"T0853: Scripting","description":"Communicate with Triconex Tricon PLCs using its custom Python script. The script uses four Python modules that collectively implement the TriStation protocol via UDP port 1502","timestamp":"","reference":"https://attack.mitre.org/techniques/T0853/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-16","type":"action","name":"T0885: Commonly Used Port","description":"Communicate over a commonly used port to bypass firewalls or network detection systems and to blend in with normal network activity, to avoid more detailed inspection","timestamp":"","reference":"https://attack.mitre.org/techniques/T0885/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"OR"},{"id":"http://flow-1/action-18","type":"action","name":"T0857: System Firmware","description":"TRITON's injector injects the payload into the Tricon PLCs' running firmware","timestamp":"","reference":"https://attack.mitre.org/techniques/T0857/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-19","type":"action","name":"T0890: Exploitation for Privilege Escalation","description":"Gain supervisor-level access and control system states by exploiting a vulnerability","timestamp":"","reference":"https://attack.mitre.org/techniques/T0890/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-22","type":"action","name":"T0820: Exploitation for Evasion","description":"TRITON's injector exploits a vulnerability in the device firmware to escalate privileges and then it disables and (later patches) a firmware RAM/ROM consistency check","timestamp":"","reference":"https://attack.mitre.org/techniques/T0820/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-24","type":"action","name":"T0872: Indicator Removal on Host","description":"After running the malicious payload, TRITON's Python script overwrites the malicious payload with a \"dummy\" program","timestamp":"","reference":"https://attack.mitre.org/techniques/T0872/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-26","type":"action","name":"T0849: Masquerading","description":"TRITON's Python script masquerades as legitimate Triconex software. TRITON's injector masquerades as a standard compiled PowerPC program for the Triconex PLC","timestamp":"","reference":"https://attack.mitre.org/techniques/T0849/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-28","type":"action","name":"T0846: Remote System Discovery","description":"TRITON's Python script can autodetect Triconex PLCs on the network by sending a UDP broadcast packet over port 1502","timestamp":"","reference":"https://attack.mitre.org/techniques/T0846/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-30","type":"action","name":"T0843: Program Download","description":"TRITON leverages the TriStation protocol to download programs to the Tricon PLCs","timestamp":"","reference":"https://attack.mitre.org/techniques/T0843/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-32","type":"action","name":"T0868: Detect Operating Mode","description":"A TRITON Python module provides string representations of different features of the TriStation protocol, including message and error codes, key position states, and other values returned by the status functions","timestamp":"","reference":"https://attack.mitre.org/techniques/T0868/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-39","type":"action","name":"T0845: Program Upload","description":"TRITON uploads its payload to the Tricon PLCs","timestamp":"","reference":"https://attack.mitre.org/techniques/T0845/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-41","type":"action","name":"T0855: Unauthorised Command Message","description":"Use TRITON to prevent the Tricon PLC from functioning appropriately","timestamp":"","reference":"https://attack.mitre.org/techniques/T0855/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-43","type":"action","name":"T0880: Loss of Safety","description":"TRITON can reprogram the safety PLC logic to allow unsafe conditions or state to persist","timestamp":"","reference":"https://attack.mitre.org/techniques/T0880/","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}],"assets":[{"id":"http://flow-1/asset-2","type":"asset","state":"access gained & manipulated"},{"id":"http://flow-1/asset-4","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-7","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-10","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-12","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-14","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-17","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-20","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-21","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-23","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-25","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-27","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-29","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-31","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-38","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-40","type":"asset","state":"compromised"},{"id":"http://flow-1/asset-42","type":"asset","state":"compromised"}],"relationships":[{"source":"http://flow-1/asset-2","type":"http://flow-1#state","target":"http://flow-1/action-1"},{"source":"http://flow-1/action-1","type":"http://flow-1#state-change","target":"http://flow-1/asset-4"},{"source":"http://flow-1/asset-4","type":"http://flow-1#state","target":"http://flow-1/action-5"},{"source":"http://flow-1/asset-4","type":"http://flow-1#state","target":"http://flow-1/action-6"},{"source":"http://flow-1/action-5","type":"http://flow-1#state-change","target":"http://flow-1/asset-7"},{"source":"http://flow-1/action-6","type":"http://flow-1#state-change","target":"http://flow-1/asset-7"},{"source":"http://flow-1/asset-7","type":"http://flow-1#state","target":"http://flow-1/action-9"},{"source":"http://flow-1/action-9","type":"http://flow-1#state-change","target":"http://flow-1/asset-10"},{"source":"http://flow-1/asset-10","type":"http://flow-1#state","target":"http://flow-1/action-11"},{"source":"http://flow-1/action-11","type":"http://flow-1#state-change","target":"http://flow-1/asset-12"},{"source":"http://flow-1/asset-12","type":"http://flow-1#state","target":"http://flow-1/action-13"},{"source":"http://flow-1/action-13","type":"http://flow-1#state-change","target":"http://flow-1/asset-14"},{"source":"http://flow-1/asset-14","type":"http://flow-1#state","target":"http://flow-1/action-15"},{"source":"http://flow-1/asset-14","type":"http://flow-1#state","target":"http://flow-1/action-16"},{"source":"http://flow-1/action-15","type":"http://flow-1#state-change","target":"http://flow-1/asset-17"},{"source":"http://flow-1/action-16","type":"http://flow-1#state-change","target":"http://flow-1/asset-17"},{"source":"http://flow-1/asset-17","type":"http://flow-1#state","target":"http://flow-1/action-18"},{"source":"http://flow-1/action-18","type":"http://flow-1#state-change","target":"http://flow-1/asset-20"},{"source":"http://flow-1/asset-20","type":"http://flow-1#state","target":"http://flow-1/action-19"},{"source":"http://flow-1/action-19","type":"http://flow-1#state-change","target":"http://flow-1/asset-21"},{"source":"http://flow-1/asset-21","type":"http://flow-1#state","target":"http://flow-1/action-22"},{"source":"http://flow-1/action-22","type":"http://flow-1#state-change","target":"http://flow-1/asset-23"},{"source":"http://flow-1/asset-23","type":"http://flow-1#state","target":"http://flow-1/action-24"},{"source":"http://flow-1/action-24","type":"http://flow-1#state-change","target":"http://flow-1/asset-25"},{"source":"http://flow-1/asset-25","type":"http://flow-1#state","target":"http://flow-1/action-26"},{"source":"http://flow-1/action-26","type":"http://flow-1#state-change","target":"http://flow-1/asset-27"},{"source":"http://flow-1/asset-27","type":"http://flow-1#state","target":"http://flow-1/action-28"},{"source":"http://flow-1/action-28","type":"http://flow-1#state-change","target":"http://flow-1/asset-29"},{"source":"http://flow-1/asset-29","type":"http://flow-1#state","target":"http://flow-1/action-30"},{"source":"http://flow-1/action-30","type":"http://flow-1#state-change","target":"http://flow-1/asset-31"},{"source":"http://flow-1/asset-31","type":"http://flow-1#state","target":"http://flow-1/action-32"},{"source":"http://flow-1/action-32","type":"http://flow-1#state-change","target":"http://flow-1/asset-38"},{"source":"http://flow-1/asset-38","type":"http://flow-1#state","target":"http://flow-1/action-39"},{"source":"http://flow-1/action-39","type":"http://flow-1#state-change","target":"http://flow-1/asset-40"},{"source":"http://flow-1/asset-40","type":"http://flow-1#state","target":"http://flow-1/action-41"},{"source":"http://flow-1/action-41","type":"http://flow-1#state-change","target":"http://flow-1/asset-42"},{"source":"http://flow-1/asset-42","type":"http://flow-1#state","target":"http://flow-1/action-43"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-1"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-5"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-6"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-9"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-11"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-13"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-15"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-16"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-18"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-19"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-22"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-24"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-26"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-28"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-30"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-32"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-39"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-41"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-43"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-2"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-4"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-7"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-10"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-12"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-14"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-17"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-20"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-21"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-23"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-25"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-27"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-29"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-31"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-38"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-40"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-42"}],"object_properties":[],"data_properties":[{"source":"http://flow-1/asset-2","type":"http://flow-1#description","target":"foreign oil refinery's safety devices"},{"source":"http://flow-1/asset-7","type":"http://flow-1#description","target":"shut down refinery for several days"}]}